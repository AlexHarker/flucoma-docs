# Part of the Fluid Corpus Manipulation Project (http://www.flucoma.org/)
# Copyright 2017-2019 University of Huddersfield.
# Licensed under the BSD-3 License.
# See license.md file in the project root for full license information.
# This project has received funding from the European Research Council (ERC)
# under the European Unionâ€™s Horizon 2020 research and innovation programme
# (grant agreement No 725899).
---
digest: Cluster data points with K-Means
sc-categries: FluidManipulation
sc-related: Classes/FluidDataSet, Classes/FluidLabelSet, Classes/FluidKNNClassifier, Classes/FluidKNNRegressor
see-also: 
description: |
  Uses the K-Means algorithm to learn clusters from a :fluid-obj:`FluidDataSet`

  https://scikit-learn.org/stable/tutorial/statistical_inference/unsupervised_learning.html#clustering-grouping-observations-together

parameters:
  numClusters:
    description: |
      The number of clusters to classify data into.
  maxIter:
    description: |
      The maximum number of iterations the algorithm will use whilst fitting.
messages: 
  fit:
   description: |
      Identify `k` clusters in a :fluid-obj:`FluidDataSet`
   args:
    - name: dataSet
      description: |
        A :fluid-obj:`FluidDataSet` of data points.
    - name: action
      description: |
        A function to run when fitting is complete, taking as its argument an array with the number of data points for each cluster.
  predict:
   description: |
      Given a trained object, return the cluster ID for each data point in a DataSet to a label set.
   args:
    - name: dataSet
      description: |
        a :fluid-obj:`FluidDataSet` containing the data to predict.
    - name: labelSet
      description: |
        a :fluid-obj:`FluidLabelSet` to retrieve the predicted clusters.
    - name: action
      description: |
        A function to run when the server responds.
  fitPredict:
   description: |
      Run :fluid-obj:`FluidKMeans#*fit` and :fluid-obj:`FluidKMeans#*predict` in a single pass: i.e. train the model on the incoming :fluid-obj:`FluidDataSet` and then return the learned clustering to the passed :fluid-obj:`FluidLabelSet`
   args:
    - name: dataSet
      description: |
        a :fluid-obj:`FluidDataSet` containing the data to fit and predict.
    - name: labelSet
      description: |
        a :fluid-obj:`FluidLabelSet` to retrieve the predicted clusters.
    - name: action
      description: |
        A function to run when the server responds
  predictPoint:
   description: |
      Given a trained object, return the cluster ID for a data point in a |buffer|
   args:
    - name: buffer
      description: |
        a |buffer| containing a data point.
    - name: action
      description: |
        A function to run when the server responds, taking the ID of the cluster as its argument.
  predict:
   description: |
      Report cluster assignments for previously unseen data.
   args:
    - name: dataSet
      description: |
        A :fluid-obj:`FluidDataSet` of data points.
    - name: labelSet
      description: |
        A :fluid-obj:`FluidLabelSet` to contain assignments.
    - name: action
      description: |
        A function to run when complete, taking an array of the counts for each category as its argument.
